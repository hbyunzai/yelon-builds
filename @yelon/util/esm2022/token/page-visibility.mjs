import { DOCUMENT } from '@angular/common';
import { inject, InjectionToken } from '@angular/core';
import { fromEvent, distinctUntilChanged, map, share, startWith } from 'rxjs';
/**
 * Use the `visibilitychange` event to monitor whether the browser tab is visible, which is generally used when the user leaves the browser tab to temp interrupt the backend to continue sending requests
 *
 * 通过 `visibilitychange` 事件来监听浏览器选项卡是否可见，一般用于当用户离开应用时暂时中断后端持续发送请求时
 */
export const PAGE_VISIBILITY = new InjectionToken('PAGE_VISIBILITY`', {
    factory: () => {
        const doc = inject(DOCUMENT);
        return fromEvent(doc, 'visibilitychange').pipe(startWith(0), map(() => !doc.hidden), distinctUntilChanged(), share());
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFnZS12aXNpYmlsaXR5LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcGFja2FnZXMvdXRpbC90b2tlbi9wYWdlLXZpc2liaWxpdHkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBRSxNQUFNLEVBQUUsY0FBYyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3ZELE9BQU8sRUFBRSxTQUFTLEVBQWMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFFMUY7Ozs7R0FJRztBQUNILE1BQU0sQ0FBQyxNQUFNLGVBQWUsR0FBRyxJQUFJLGNBQWMsQ0FBc0Isa0JBQWtCLEVBQUU7SUFDekYsT0FBTyxFQUFFLEdBQUcsRUFBRTtRQUNaLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM3QixPQUFPLFNBQVMsQ0FBQyxHQUFHLEVBQUUsa0JBQWtCLENBQUMsQ0FBQyxJQUFJLENBQzVDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFDWixHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQ3RCLG9CQUFvQixFQUFFLEVBQ3RCLEtBQUssRUFBRSxDQUNSLENBQUM7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRE9DVU1FTlQgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgaW5qZWN0LCBJbmplY3Rpb25Ub2tlbiB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgZnJvbUV2ZW50LCBPYnNlcnZhYmxlLCBkaXN0aW5jdFVudGlsQ2hhbmdlZCwgbWFwLCBzaGFyZSwgc3RhcnRXaXRoIH0gZnJvbSAncnhqcyc7XG5cbi8qKlxuICogVXNlIHRoZSBgdmlzaWJpbGl0eWNoYW5nZWAgZXZlbnQgdG8gbW9uaXRvciB3aGV0aGVyIHRoZSBicm93c2VyIHRhYiBpcyB2aXNpYmxlLCB3aGljaCBpcyBnZW5lcmFsbHkgdXNlZCB3aGVuIHRoZSB1c2VyIGxlYXZlcyB0aGUgYnJvd3NlciB0YWIgdG8gdGVtcCBpbnRlcnJ1cHQgdGhlIGJhY2tlbmQgdG8gY29udGludWUgc2VuZGluZyByZXF1ZXN0c1xuICpcbiAqIOmAmui/hyBgdmlzaWJpbGl0eWNoYW5nZWAg5LqL5Lu25p2l55uR5ZCs5rWP6KeI5Zmo6YCJ6aG55Y2h5piv5ZCm5Y+v6KeB77yM5LiA6Iis55So5LqO5b2T55So5oi356a75byA5bqU55So5pe25pqC5pe25Lit5pat5ZCO56uv5oyB57ut5Y+R6YCB6K+35rGC5pe2XG4gKi9cbmV4cG9ydCBjb25zdCBQQUdFX1ZJU0lCSUxJVFkgPSBuZXcgSW5qZWN0aW9uVG9rZW48T2JzZXJ2YWJsZTxib29sZWFuPj4oJ1BBR0VfVklTSUJJTElUWWAnLCB7XG4gIGZhY3Rvcnk6ICgpID0+IHtcbiAgICBjb25zdCBkb2MgPSBpbmplY3QoRE9DVU1FTlQpO1xuICAgIHJldHVybiBmcm9tRXZlbnQoZG9jLCAndmlzaWJpbGl0eWNoYW5nZScpLnBpcGUoXG4gICAgICBzdGFydFdpdGgoMCksXG4gICAgICBtYXAoKCkgPT4gIWRvYy5oaWRkZW4pLFxuICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcbiAgICAgIHNoYXJlKClcbiAgICApO1xuICB9XG59KTtcbiJdfQ==