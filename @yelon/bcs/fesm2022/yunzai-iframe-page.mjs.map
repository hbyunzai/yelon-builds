{"version":3,"file":"yunzai-iframe-page.mjs","sources":["../../../../packages/bcs/yunzai-iframe-page/yunzai-iframe-page.component.ts","../../../../packages/bcs/yunzai-iframe-page/yunzai-iframe-page.module.ts","../../../../packages/bcs/yunzai-iframe-page/yunzai-iframe-page.ts"],"sourcesContent":["import { CommonModule } from '@angular/common';\nimport { Component, OnDestroy, OnInit } from '@angular/core';\nimport { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';\n\nimport { MenuService } from '@yelon/theme';\nimport { LayoutDefaultService } from '@yelon/theme/layout-default';\nimport { NzSafeAny } from 'ng-zorro-antd/core/types';\n\n@Component({\n  selector: 'yunzai-iframe-page',\n  template: `\n    <div class=\"yunzai-iframe-page\" *ngIf=\"hasIframe\" [style.height]=\"iframePageHeight\">\n      <iframe [src]=\"iframeSafeSrc\">\n        <p>您的浏览器不支持 iframe 标签。</p>\n      </iframe> </div\n    >,\n  `,\n  imports: [CommonModule],\n  standalone: true\n})\nexport class YunzaiIframePageComponent implements OnInit, OnDestroy {\n  // iframe转换后的安全路径\n  iframeSafeSrc!: SafeResourceUrl;\n\n  // 是否有iframe地址\n  hasIframe: boolean = false;\n\n  iframePageHeight!: string;\n\n  resizeHandle: NzSafeAny;\n  constructor(\n    private sanitizer: DomSanitizer,\n    private menuSrv: MenuService,\n    private layoutDefaultService: LayoutDefaultService\n  ) {}\n\n  ngOnInit(): void {\n    this.iframePageHeight = this.layoutDefaultService.options.hideHeader\n      ? `${window.innerHeight - 55}px`\n      : `${window.innerHeight - 64 - 55}px`;\n\n    this.resizeHandle = () => {\n      this.iframePageHeight = this.layoutDefaultService.options.hideHeader\n        ? `${window.innerHeight - 55}px`\n        : `${window.innerHeight - 64 - 55}px`;\n    };\n    window.addEventListener('resize', this.resizeHandle);\n    this.getIframeUrl();\n  }\n\n  getIframeUrl(): void {\n    this.menuSrv.getRouterLink().subscribe((url: NzSafeAny) => {\n      if (url) {\n        this.hasIframe = true;\n        this.iframeSafeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(url);\n      } else {\n        if (localStorage.getItem('iframeSrc')) {\n          this.hasIframe = true;\n          const url: string = localStorage.getItem('iframeSrc') as string;\n          this.iframeSafeSrc = this.sanitizer.bypassSecurityTrustResourceUrl(url);\n        } else {\n          this.hasIframe = false;\n        }\n      }\n    });\n  }\n\n  ngOnDestroy(): void {\n    window.removeEventListener('resize', this.resizeHandle);\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\n\nimport { YunzaiIframePageComponent } from './yunzai-iframe-page.component';\n\nconst COMPONENTS = [YunzaiIframePageComponent];\n\n@NgModule({\n  imports: [CommonModule, ...COMPONENTS],\n  exports: COMPONENTS\n})\nexport class YunzaiIframePageModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}